# الدليل المتقدم لـ Codeml

بقلم: جوزيف بيلاوسكي

***

ورشة عمل 2022 حول التطور الجزيئي في MBL

***

اتبع هذا [الرابط للعودة إلى صفحة جدول الورشة](https://molevolworkshop.github.io/schedule/).

اتبع هذا [الرابط للعودة إلى صفحة أعضاء هيئة التدريس بيلاوسكي](https://molevolworkshop.github.io/faculty-bielawski/).

## نظرة عامة
الهدف من هذا النشاط هو مساعدتك على فهم كيفية استخدام نماذج الكودونات المختلفة، وكيفية اختبار الانتقاء باستخدام برنامج PAML (وبشكل محدد برنامج CODEML). تم تصميم الأنشطة لبناء مهارات تحليلية عامة، وهي ذات صلة أيضاً بالتحليلات التي تُجرى باستخدام حزم برامج أخرى، مثل HyPhy.

ينقسم الدليل إلى 4 تمارين.

1. تقدير الاحتمالية القصوى (يدوياً)
2. حساسية _ω_
3. اختبارات نسبة الاحتمالية للفرضيات البديلة حول التغيرات الزمنية في ضغط الانتقاء
4. اختبار للمواقع التي تتطور بواسطة الانتقاء الإيجابي في جين nef لفيروس HIV-2

**ملاحظة: ابتداءً من عام 2023، في ورشة العمل حول التطور الجزيئي سنقوم فقط بالتمارين 1، 3 و4. وهذا يشمل الخطوة الاختيارية (رقم 8) من التمرين 4.**

يشرح القسم التالي (**الوصول إلى الملفات**) كيفية الوصول إلى الملفات المطلوبة لكل تمرين. ستصل إلى الملفات بطريقة مختلفة حسب ما إذا كنت تقوم بالمعاملات في الورشة أو تعمل على المنزل بشكل مستقل عن الورشة.

**ملاحظة** أن تشغيل البرنامج يتضمن تعديل ملفات الإدخال وإنشاء ملفات الإخراج. _من الأفضل إنشاء دليل منفصل لكل تمرين أو تحليل بيانات حقيقي ترغب في القيام به و(2) تسجيل وحفظ ملاحظات نصية بسيطة حول دوافع وتفاصيل كل تحليل بيانات حقيقية وتخزينها ضمن الدليل الذي تم إنشاؤه لكل تحليل._ يعتبر هذا الأخير بمثابة ملف "اقرأني" الذي ستكون سعيداً بوجوده بعد أن تجري العديد من التحليلات على بياناتك الحقيقية وتبدأ في نسيان أو خلط التفاصيل.

إليك شرائح النشاط التعليمي لبرنامج PAML: [2024_slides](http://awarnach.mathstat.dal.ca/%7Ejoeb/PAML_lab/resources/pamlDEMO_2024.pdf)

إليك نسخة من الفصل الكتابي المرافق لهذه التمارين: [Book_Chapter.pdf](http://awarnach.mathstat.dal.ca/%7Ejoeb/PAML_lab/resources/Bielawski_book_chapter.pdf)

هذه [الصفحة](http://awarnach.mathstat.dal.ca/%7Ejoeb/PAML_lab/Resources.html) تحتوي على روابط إلى وثائق مفيدة والعديد من المصادر الإضافية.

## الوصول إلى الملفات

### **1. إذا كنت تقوم بالمعمل خلال الورشة:**
على الآلات الافتراضية التي سنستخدمها في ورشة العمل 2022، سيكون هناك رابط رمزي في دليل المنزل الخاص بك يسمى "moledata" والذي ينقلك إلى ملفات بيانات الدورة. هناك ستجد أدلة للمعاملات المختلفة (على سبيل المثال، MSAlab، revbayes، PamlLab، إلخ).

لعرض قائمة المعاملات اكتب:

```
ls ~/moledata
```

لعرض محتويات معمل PAML اكتب:

```
ls -1 ~/moledata/PamlLab
```

هذا سيكشف عن الأدلة لكل تمرين:

```
ex1
ex2
ex3
ex4
```

الملفات موجودة بالفعل على الآلة الافتراضية التي تستخدمها. _ومع ذلك، سترغب في تشغيل كل تمرين في دليل منفصل تقوم بإنشائه_. لذا، أنشئ دليلاً جديداً. اسم الدليل الجديد يعود لك، ولكن اختر شيئاً توضيحياً (على سبيل المثال، `~/PAML_ex1`).

لـ _نسخ_ الملفات المطلوبة للتمرين 1 فقط اكتب:

```
cp ~/moledata/PamlLab/ex1/* ~/PAML_ex1
```

الآن أنت جاهز للقيام بالتمرين 1 ضمن `~/PAML_ex1`.

### **2. إعادة تسمية الملفات:**
لكل التمارين ستحتاج إلى إعادة تسمية ملف التحكم عن طريق إزالة بادئة التمرين (exN). يمكنك القيام بذلك باستخدام أمر `cp`.

إليك مثال للتمرين 1:

```
cp ex1_codeml.ctl codeml.ctl
```

تحذير: إعادة تشغيل PAML داخل دليل ستؤدي إلى استبدال جميع الملفات داخل ذلك الدليل! تأكد من إعادة تسمية جميع الملفات التي تريد الاحتفاظ بها!

### **3. إذا كنت تقوم بالمعمل بشكل مستقل عن الورشة:**
يمكنك القيام بهذا المعمل عن طريق تنزيل جميع الملفات الضرورية من أرشيف [هنا](https://bitbucket.org/EvoWorks/protocol-paml-lab-at-mbl-workshop/downloads/)، أو يمكنك تنزيل الملفات بشكل فردي لكل تمرين حسب الحاجة [هنا](http://awarnach.mathstat.dal.ca/%7Ejoeb/PAML_lab/PAML_Lab_files.html).

على أي حال، من الأفضل _"الممارسة الفضلى"_ تشغيل كل تمرين في دليل عمل منفصل تقوم بإنشائه (على سبيل المثال، `PAML_ex1`)، والعمل بنسخ من الملفات المطلوبة ضمن ذلك الدليل.

## التمرين 1
الهدف من هذا النشاط هو استخدام CODEML لتقييم احتمالية تسلسلات GstD1 لقيم مختلفة من _ω_. قم برسم منحنيات تسجيل الاحتمالية مقابل قيم _ω_ وحدد تقدير الاحتمالية القصوى لـ _ω_. تحقق من نتيجتك عن طريق تشغيل خوارزمية التسلق على التل الخاصة بـ CODEML.

![Concept_figure1](https://github.com/user-attachments/assets/869cb3c5-5530-488f-8ebd-4f0e7cf027af)

1. اعثر على ملفات الإدخال للتمرين 1 (**ex1_codeml.ctl, seqfile.txt**) وتعرف عليها جيداً. انتبه جيداً إلى محتويات ملف التحكم المعدل المسمى **ex1_codeml.ctl**.

2. تذكر إنشاء دليل حيث تريد أن تضع نتائجك، ووضع جميع ملفاتك بداخله. الآن افتح نافذة طرفية، وانتقل إلى الدليل الذي يحتوي على ملفاتك. عندما تكون جاهزاً لتشغيل CODEML، احذف بادئة **ex1_** (يجب أن يكون ملف التحكم مسمى **codeml.ctl**). الآن يمكنك تشغيل CODEML.

3. تعرف على النتائج (انظر التعليقات التوضيحية في [ex1_HelpFile.pdf](http://awarnach.mathstat.dal.ca/%7Ejoeb/PAML_lab/exercise1/ex1_HelpFile.pdf)). إذا لم تقم بتعديل ملف التحكم، ستُكتب النتائج في ملف يسمى **results.txt**. حدد السطر داخل ملف النتائج الذي يعطي تسجيل الاحتمالية لمجموعة البيانات التجريبية.

4. _الآن قم بتعديل وحفظ_ ملف التحكم وأعد تشغيل CODEML لقيمة ثابتة مختلفة لـ _ω_. قد يكون ملف "الدليل السريع" لملف التحكم مفيداً هنا ([الدليل السريع](http://awarnach.mathstat.dal.ca/%7Ejoeb/PAML_lab/exercise1/ex1_control_file_QuickGuide.pdf)). الهدف هو حساب احتمالية مجموعة البيانات التجريبية مع قيمة ثابتة لـ _ω_. _قم بتعديل ملف التحكم كما يلي:_
   * قم بتغيير اسم ملف النتيجة (عن طريق `outfile=` في ملف التحكم) وإلا ستستبدل نتائجك السابقة!
   * قم بتغيير القيمة الثابتة لـ omega عن طريق تغيير القيمة لـ `omega=` في ملف التحكم. القيم لهذا التمرين موضحة كتعليقات في أسفل ملف التحكم التجريبي الذي تم تزويدك به.

5. كرر الخطوة 4 لكل قيمة من قيم _ω_ وفقاً للتعليقات في ملف التحكم التجريبي (على سبيل المثال، _ω_= 0.005, 0.01, 0.05, 0.1, 0.2, 0.4, 0.8, 1.6, 2.0).

6. استخدم برنامج الجداول المفضل لديك أو حزمة إحصائية لرسم تسجيل الاحتمالية (المحور y) مقابل القيمة الثابتة لـ omega (المحور x). استخدم مقياساً لوغاريتمياً للمحور x (لا تقم بتحويل _ω_). يجب أن تبدو رسومتك كالتالي: [ex1 plot template.pdf](http://awarnach.mathstat.dal.ca/%7Ejoeb/PAML_lab/exercise1/ex1_plot_template.pdf) (ملاحظة: نقاط البيانات قد تم حجبها عمدًا في هذا الإصدار من الرسم؛ ستحتاج إلى توليد البيانات بنفسك).
   * للمساعدة في رسم النتائج، راجع الموارد الإضافية على [هذه الصفحة](http://awarnach.mathstat.dal.ca/%7Ejoeb/PAML_lab/Resources.html).

7. من خلال الرسم الخاص بك، حاول الإجابة على السؤال التالي:
   * _ما هي قيمة ω التي ستعظم تسجيل الاحتمالية (أي، تقدير الاحتمالية القصوى)؟_

8. الآن قم بتعديل ملف التحكم بحيث يستخدم CODEML خوارزمية التسلق على التل لإيجاد تقدير الاحتمالية القصوى؛ قم بتعيين `fix_omega=0` في ملف التحكم. قارن النتيجة بتقديرك من الخطوة 7.
   * _ما مدى دقة تقديرك لـ MLE؟_

## التمرين 2
في هذا التمرين ستستكشف حساسية _ω_ بالنسبة لنسبة الانتقالات/التحولات (kappa)، وإلى الترددات المفترضة للكودونات (_π's_). بعد جمع البيانات المطلوبة، ستحدد أي الافتراضات تعطي أكبر وأصغر قيم لـ S، وما هو تأثير ذلك على قيمة _ω_.

![Concept_figure2](https://github.com/user-attachments/assets/e185f81c-3b52-4486-b1ec-2b6ba7b055b0)

1. اعثر على ملفات التمرين 2 (**ex2_codeml.ctl, seqfile.txt**) وتعرف عليها جيداً. سيكون من الأفضل إنشاء دليل جديد للتمرين 2. عندما تكون جاهزاً لتشغيل CODEML، احذف بادئة **ex2_** (يجب أن يكون ملف التحكم مسمى **codeml.ctl**).

2. شغل CODEML باستخدام الإعدادات في ملف التحكم للتمرين 2. تعرف على النتائج ([ex2 HelpFile.pdf](http://awarnach.mathstat.dal.ca/%7Ejoeb/PAML_lab/exercise2/ex2_HelpFile.pdf)). بالإضافة إلى تسجيل الاحتمالية، يجب أن تكون قادرًا على تحديد الجزء من ملف النتائج الذي يقدم تقديرات لما يلي:
   * عدد المواقع المتناظرة وغير المتناظرة (S و N)
   * معدلات التغير المتناظر وغير المتناظر (dS و dN)

3. كما في التمرين 1، ستحتاج إلى _تعديل وحفظ_ ملفات التحكم وإعادة تشغيل CODEML. قد يكون ملف "الدليل السريع" لملف التحكم مفيداً هنا ([الدليل السريع](http://awarnach.mathstat.dal.ca/%7Ejoeb/PAML_lab/exercise2/ex2_control_file_QuickGuide.pdf)). الهدف هو حساب احتمالية مجموعة البيانات التجريبية تحت افتراضات نموذجية مختلفة. للقيام بذلك يجب عليك:
   * _تغيير_ اسم ملف النتيجة الرئيسي (عن طريق `outfile=` في ملف التحكم) وإلا ستستبدل نتائجك السابقة.
   * _تغيير_ الافتراضات النموذجية حول ترددات الكودونات (عن طريق `CodonFreq=`) وkappa (عن طريق `kappa=` و `fix_kappa=`).

4. كرر الخطوة 3 لكل مجموعة من الافتراضات حول ترددات الكودونات وkappa كما هو موضح في التعليقات أسفل ملف التحكم التجريبي، والمبين في الشكل أدناه.

![Concept_figure2 2](https://github.com/user-attachments/assets/f5872c74-79fb-4d5c-b1b3-7f212b0dd7d2)

5. في برنامج الجداول المفضل لديك، أنشئ جدولاً مثل **الجدول E2** في الشرائح (انظر [ex2 table template.pdf](http://awarnach.mathstat.dal.ca/%7Ejoeb/PAML_lab/exercise2/ex2_table_template.pdf)) واملأه بنتائجك.

6. استخدم جدولك لتحديد:
   * _أي الافتراضات تعطي أكبر وأصغر قيم لـ S؟_
   * _ما هو التأثير على ω؟_
   * _أي نموذج ستختار؟_

## التمرين 3
الهدف من هذا التمرين هو استخدام ثلاثة اختبارات نسبة الاحتمالية لتقييم الاحتمالات التالية: (1) زيادة معدل الطفرة في Ldh-C مقارنةً بـ Ldh-A، (2) حدوث دفعة من الانتقاء الإيجابي للتباين الوظيفي بعد حدث الازدواج الجيني الذي أدى إلى ظهور Ldh-C، و(3) حدوث تغيير طويل الأمد في القيود الانتقائية بعد حدث الازدواج الجيني الذي أدى إلى ظهور Ldh-C.

1. احصل على ملفات التمرين 3 من موقع الدورة الإلكتروني (**ex3_codeml.ctl, seqfile.txt, treeH0.txt, treeH1.txt, treeH2.txt, treeH3.txt**). تمثل ملفات الشجرة الفرضيات المختلفة المشار إليها بـ H0، H1، H2 وH3 (انظر المخطط أدناه، أو قم بتنزيل هذا الملف [genetree](http://awarnach.mathstat.dal.ca/%7Ejoeb/PAML_lab/exercise3/LDH_gene_tree.pdf)). المفاهيم التطورية الموضحة أعلاه تغطي هذه الفرضيات الدقيقة الأربعة:
   * H0: ضغط انتقائي متجانس عبر الشجرة (المفهوم = أي فروقات في المعدل تعود لتغيرات في معدل الطفرة).
   * H1: تغيير عرضي في ضغط الانتقاء في Ldh-C (المفهوم = فقط في الفرع الذي يلي مباشرة حدث الازدواج الجيني).
   * H2: تغيير طويل الأمد في ضغط الانتقاء في Ldh-C فقط (المفهوم = لدى Ldh-C ضغط انتقائي جديد مقارنة بأسلافه، في حين يبقى Ldh-A خاضعاً لمستوى الانتقاء الأساسي).
   * H3: تغيير طويل الأمد في الانتقاء على كل من Ldh-C وLdh-A (المفهوم = كلا الخطين المتشابهين يواجهان ضغوط انتقائية جديدة؛ أي، تختلف عن بعضها البعض وعن السلف).

![LDH_gene_tree](https://github.com/user-attachments/assets/fd5d3ebc-de43-41e1-ba1b-a0fc7bcfbf07)

2. شغل CODEML باستخدام الإعدادات في ملف التحكم للتمرين 3. تعرف على النتائج ([ex3_HelpFile.pdf](http://awarnach.mathstat.dal.ca/%7Ejoeb/PAML_lab/exercise3/ex3_HelpFile.pdf)). بالإضافة إلى تسجيل الاحتمالية، يجب أن تكون قادرًا على تحديد التقديرات الخاصة ببارامتر _ω_ لكل فرع. (في التشغيل الأول، ستكون قيم _ω_ الخاصة بكل فرع متماثلة. في التشغيلات اللاحقة سيكون هناك اختلافات بين بعض الفروع).

3. كما في التمارين السابقة، ستحتاج إلى _تعديل ملف التحكم_ وإعادة تشغيل CODEML. قد يكون ملف "الدليل السريع" لملف التحكم مفيداً هنا ([الدليل السريع](http://awarnach.mathstat.dal.ca/%7Ejoeb/PAML_lab/exercise3/ex3_control_file_QuickGuide.pdf)). الهدف هو حساب الاحتمالية وتقدير بارامترات _ω_ تحت نماذج مختلفة لتغير ضغط الانتقاء في أجزاء مختلفة من الشجرة. نظرًا لأن المعلومات النموذجية ذات الصلة موجودة في ملف الشجرة، ستحتاج إلى تحديد واحد من عدة ملفات شجرة في كل تحليل، وتعديل ملف التحكم ليقرأ ملف الشجرة المطلوب.
   * كما هو الحال دائماً، يجب أن _تغير_ اسم ملف النتيجة الرئيسي (عن طريق `outfile=` في ملف التحكم) وإلا ستستبدل نتائجك السابقة.
   * _تغيير_ الافتراضات النموذجية حول قيم _ω_ الخاصة بكل فرع عن طريق تغيير ملفات الشجرة (عن طريق `treefile=` و `model=`) المحددة في ملف التحكم.

4. كرر الخطوة 3 لكل من ملفات الشجرة الأربعة التي تم تزويدك بها. مرة أخرى، احتفظ بسجل نتائجك باستخدام جدول مثل **الجدول E3** المبين في الشرائح (انظر [ex3 table template.pdf](http://awarnach.mathstat.dal.ca/%7Ejoeb/PAML_lab/exercise3/ex3_table_template.pdf)). بالإضافة إلى ذلك، قم بإجراء اختبارات نسبة الاحتمالية (LRT) للفرضيات التالية. راجع ملاحظات المحاضرة للحصول على تفاصيل إضافية حول اختبارات LRT. استخدم درجة حرية واحدة للحصول على قيمة _P_ لكل اختبار. (للمساعدة في حساب قيمة _P_: [حاسبة مربع كاي](https://homepage.divms.uiowa.edu/%7Embognar/applets/chisq.html))
   * H0 مقابل H1
   * H0 مقابل H2
   * H2 مقابل H3

5. استخدم جدول نتائجك لتحديد:
   * _أي نموذج/نماذج مدعومة بالبيانات؟_
   * _ما هو السيناريو البيولوجي الأفضل لتفسير تطور عائلة جينات Ldh؟_
   * _هل هناك دليل على الانتقاء الإيجابي خلال تاريخ تطور Ldh؟_
   * _هل هناك أي سيناريوهات يمكن فيها أن يكون Ldh قد تطور بواسطة الانتقاء الإيجابي لكن هذه الاختبارات لا تكتشفه؟_

## التمرين 4
الهدف من هذا التمرين هو استخدام سلسلة من اختبارات نسبة الاحتمالية لـ _اختبار المواقع_ التي تتطور تحت تأثير الانتقاء الإيجابي في جين nef. إذا وجدت دليلاً كبيراً على وجود انتقاء إيجابي، قم بتحديد المواقع المعنية باستخدام طرق بايز التجريبية.

1. احصل على جميع ملفات التمرين 4 (**ex4_codeml.ctl.txt, ex4_seqfile.txt, treeM0.txt, treeM1.txt, treeM2.txt, treeM3.txt, treeM7.txt, treeM8.txt**). عندما تكون جاهزاً لتشغيل CODEML، تذكر حذف بادئة **ex4_** (يجب أن يكون ملف التحكم مسمى **codeml.ctl**).

2. إذا كنت تخطط لتشغيل نموذجين أو أكثر في نفس الوقت، فأنشئ دليلاً منفصلاً لكل تشغيل وضع نسخة من ملف التسلسل، وملف التحكم المطلوب وملف الشجرة في كل دليل.

![Models_figure_v2](https://github.com/user-attachments/assets/5158fe8e-3df3-4246-9c42-24c56eacc9e7)

3. كما في جميع التمارين السابقة، ستحتاج إلى _تعديل ملف التحكم_ وإعادة تشغيل CODEML عدة مرات. في هذه الحالة، ستقوم بتركيب ستة نماذج كودونية مختلفة (M0، M1a، M2a، M3، M7 و M8) على مجموعة البيانات التجريبية. قد يكون ملف "[الدليل السريع](http://awarnach.mathstat.dal.ca/%7Ejoeb/PAML_lab/exercise4/ex4_control_file_QuickGuide.pdf)" لملف التحكم مفيداً هنا (دليل سريع).
   * إذا كنت تقوم بتشغيل تحليلاتك بالتتابع في نفس الدليل، فيجب عليك **تغيير اسم ملف النتيجة الرئيسي** (عن طريق `outfile=` في ملف التحكم) وإلا ستستبدل نتائجك السابقة.
   * عيّن ملف الشجرة باستخدام `treefile=`. لقد قمت بتزويد ملفات شجرة مُحمّلة مسبقاً بأطوال الفروع القصوى لكل نموذج (لذا ستحتاج إلى تعيين شجرة مختلفة لكل نموذج). هذا سيسرع تحليلاتك بشكل كبير، مما يمنحك المزيد من "وقت الجعة". راجع ملف التحكم التجريبي لمزيد من التفاصيل حول أسماء ملفات الشجرة.
   * عيّن نموذج الكودون باستخدام `NSsites=`.
   * قم بتثبيت قيمة kappa عند تقدير الاحتمالية القصوى باستخدام `kappa=`. مرة أخرى، هذا سيساعد على تسريع التحليل. راجع ملف التحكم لمعرفة قيمة kappa لكل نموذج.
   * لبعض النماذج ستحتاج أيضاً إلى تعيين عدد الفئات (ncatG) في توزيع _ω_:
      * لنموذج M3 عيّن `ncatG=3`
      * لنموذج M7 عيّن `ncatG=10`
      * لنموذج M8 عيّن `ncatG=10`
   * بمجرد اكتمال التحليل، قم بإعادة تسمية ملف rst لأن التشغيلات اللاحقة ستستبدله!
   * كرر الخطوات لكل من النماذج الستة المذكورة أعلاه.

4. احتفظ بسجل نتائجك ([ex4_HelpFile.pdf](http://awarnach.mathstat.dal.ca/%7Ejoeb/PAML_lab/exercise4/ex4_HelpFile.pdf)) باستخدام جدول مثل **الجدول E4** المبين في الشرائح (انظر [ex4 table template.pdf](http://awarnach.mathstat.dal.ca/%7Ejoeb/PAML_lab/exercise4/ex4_table_template.pdf)).

5. بالإضافة إلى ذلك، قم بإجراء اختبارات نسبة الاحتمالية التالية:
   * M0 مقابل M3 (4 درجات حرية)
   * M1a مقابل M2a (2 درجة حرية)
   * M7 مقابل M8 (2 درجة حرية)

6. أخيرًا، افتح ملف rst الذي تم إنشاؤه عند تشغيل نموذج M3 ([ex4_rst-HelpFile.pdf](http://awarnach.mathstat.dal.ca/%7Ejoeb/PAML_lab/exercise4/ex4_rst_HelpFile.pdf)). حدد أعمدة الاحتمالات الخلفية لكل موقع تحت الفئات الثلاث للمواقع في هذا النموذج. استخدم هذه البيانات لإنتاج الرسم البياني لجين nef مثل الشكل المعروض أدناه (_ستبدو رسومتك مختلفة عن الشكل المعروض أدناه_).

![Posteriors_v3](https://github.com/user-attachments/assets/8d137e0b-2650-44cb-9910-9216e66f37d4)

7. كخطوة أخيرة، حاول تجميع جميع نتائجك وحاول تقديم تفسير بيولوجي من النوع الذي تود نشره في ورقة بحثية فعلية. ينبغي أن تساعدك السؤالين العامين التاليين في بدء ذلك. أنصح بشدة بأن تقوم بهذه الخطوة الأخيرة بالتعاون مع طلاب ورشة العمل الآخرين؛ ناقشوا الأمور معاً!
   * _ما هي الاستنتاجات البيولوجية التي تدعمها هذه البيانات بشكل جيد؟_
   * _ما هي جوانب النتائج التي يمكنك تفسيرها وفقًا لمعرفتك البيولوجية السابقة بهذا النظام أو أنظمة مشابهة؟_

8. اختياري: استكشف مقدار الحساب الإضافي المطلوب لتقدير أطوال الفروع من البيانات. (تذكر، أنني قدمت تقديرات سابقة لتقدير الاحتمالية القصوى لأطوال الفروع ضمن ملف الشجرة!)
   * أعد تشغيل نموذج M0 كما في الخطوة 3 أعلاه، ولكن هذه المرة لاحظ مدى سرعة انتهاء البرنامج.
   * الآن قم بتعديل ملف التحكم لنموذج M0. عيّن `fix_blength = 0` حيث تعني القيمة 0 أنه سيتم تجاهل أطوال الفروع في ملف الشجرة وسيتم تقديرها بواسطة الاحتمالية القصوى.
   * الآن أعد تشغيل نموذج M0 مع `fix_blength = 0` ولاحظ كم من الوقت استغرق إنهاء هذا التشغيل.
   * _ما هو تأثير حجم الشجرة على اختبارات الفرضيات القائمة على الاحتمالية القصوى؟_
   * _هل تعتقد أن أطوال الفروع لها تأثير كبير على احتمالية البيانات؟ ماذا عن اختبارات الفرضيات؟ هل يمكنك التفكير بطريقة لاستخدام `fix_blength = 2` للتحقق؟_

## الخطوات التالية...
الآن بعد أن اكتسبت بعض الخبرة مع نماذج الكودونات، قد ترغب في تجربة دليل يغطي مواضيع أكثر تقدماً. يركز الدليل المتقدم على **الكشف عن التطور التكيفي العرضي** عبر "نموذج الفرع-الموقع A".

![NextSteps_figure](https://github.com/user-attachments/assets/586b16a2-1092-4ec7-8795-ef92129bb0a2)

يتضمن الدليل أيضاً **أنشطة إضافية** حول:
   * تحديد وتصنيف فروع الشجرة النشوائية لإدخالها في نماذج الكودون للفرع-الموقع
   * الكشف عن عدم استقرار في تقديرات المعاملات الخاصة بك
   * إجراء تحليلات للثبات
   * استخدام التجميع المعزز بواسطة التمهيد المملس (SBA) لتصحيح عدم اليقين وعدم الاستقرار في تقديرات المعاملات في نماذج الكودونات

تنشر البروتوكولات لكل نشاط في _بروتوكولات في المعلوماتية الحيوية_ (الوحدة 6.15). تعرض هذه الوحدة أيضًا **توصيات حول "أفضل الممارسات" عند إجراء مسح تطوري واسع النطاق** للكشف عن التطور التكيفي العرضي باستخدام PAML.

يمكنك إلقاء نظرة على ملف PDF للوحدة 6.15 من _بروتوكولات في المعلوماتية الحيوية_ هنا: [UNIT 6.15](http://awarnach.mathstat.dal.ca/%7Ejoeb/PAML_lab/resources/UNIT6.15.pdf)

الملفات المطلوبة لهذا "المعمل المتقدم" متوفرة عبر هذا المستودع على Bitbucket: [repository-link](https://bitbucket.org/EvoWorks/protocol-inference-of-episodic-selection/downloads)
